# PostgreSQL Client Authentication Configuration File
# This file is mounted read-only into the container.
#
# Add additional "host" lines for more public client IPs as needed.

# TYPE  DATABASE        USER            ADDRESS                 METHOD

# Local connections (allow postgres system user only)
local   all             postgres                                 peer
local   all             all                                      reject

# Loopback (TLS client cert only)
hostssl all             all             127.0.0.1/32            cert clientcert=verify-full
hostssl all             all             ::1/128                 cert clientcert=verify-full

# Docker network (compose bridge) â€” TLS client cert only
hostssl all             all             172.20.0.0/16           cert clientcert=verify-full

# Explicit rejects for everything else
host    all             all             0.0.0.0/0               reject
host    all             all             ::/0                    reject
